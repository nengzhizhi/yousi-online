<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf8">
		<link href="./public/css/bootstrap.min.css" rel="stylesheet">
		<link href="./public/css/dashboard.css" rel="stylesheet">
		<link href="./public/css/datetimepicker.css" rel="stylesheet">
	</head>
	<body>
		<div class="container">
			<div class="row">
				<h1 class="page-header">WebSocket连接测试</h1>
				<a href="#" onclick="join('teacher')">老师进入房间</a>
				<a href="#" onclick="join('student')">学生进入房间</a>
			</div>

			<div class="row">
				<div class="panel panel-default">
					<div class="panel-body">
					</div>
				</div>
			</div>
		</div>
	</body>
</html>



<script type="text/javascript">
var ws = new WebSocket("ws://127.0.0.1:10001",'echo-protocol');

ws.onopen = function() {
	ws.onmessage = function(event) {
		console.log(event.data);
		var req = JSON.parse(event.data);

		if (req.c=='join') {
			console.log("join result:" + event.data);
		}
	}
}

function join(role){
	if (role == 'teacher') {
		ws.send(JSON.stringify({
			c : 'join',
			data : {
				roomId : '1001',
				role : 'teacher',
				username : 'nengzhizhi'
			}
		}));		
	} else if (role == 'student') {
		ws.send(JSON.stringify({
			c : 'join',
			data : {
				roomId : '1001',
				role : 'student',
				username : 'nengzhizhi',
				answeringId : '1001-1001'
			}
		}));
	}
}
</script>